# Pick-My-AI PMC 적립 시스템

## 📌 핵심 개념

### PMC란?
**PMC (Pick-My-Coin) = AI 모델 구매 시 적립되는 포인트**

- 다음 결제 시 현금처럼 사용 가능
- 결제금액의 최대 30%까지 사용 가능
- 1회 최대 10,000원까지 사용 가능
- 적립일로부터 90일간 유효

### 수수료 정책
- **수수료율**: 11.9%
- **PMC 적립률 상한**: 수수료율(11.9%)을 초과 불가

## 🔢 PMC 적립 공식

### 최종 공식
```
PMC 적립 = Σ(모델별 결제금액 × 해당 모델 적립률)
```

**핵심**: 여러 모델을 섞어 담을수록 적립률 상승 (최대 10%)

## 📊 모델별 가격 (최신 사양)

### GPT 시리즈
- GPT-4o → 10원
- GPT-4.1 → 8원
- GPT-5 → 9원
- GPT-5.1 → 9원
- GPT-5.2 → 14원
- GPT-5 Codex → 12원

### Claude 시리즈
- Claude Haiku 3.5 → 4원
- Claude Sonnet 4.5 → 18원
- Claude Opus 4.5 → 60원
- Claude Opus 4.1 → 75원

### Perplexity
- Sonar → 1원
- Sonar Pro → 15원
- Sonar Deep Research → 8원

### 이미지
- GPT-Image-1 → 40원 / 1장

## PMC 적립 구조

### 1. 기본 적립률 계산
```
R_base = min(3% × (총 선택 수량 - 1), 10%)
```

**적립률 예시:**
- 총 1개: 0%
- 총 2개: 3%
- 총 3개: 6%
- 총 4개: 9%
- 총 5개 이상: 10% (캡)

### 2. 플랜 보너스
| 플랜 | 추가 적립 |
|------|-----------|
| Free | 0% |
| Plus | +2% |
| Pro | +5% |
| Max | +7% |

### 3. 헤드라인 적립률 (수수료율 제한)
```
R_headline = min(R_base + 플랜 보너스, 11.9%)
```

**최대 적립률: 11.9% (수수료율과 동일)**

### 4. 티어별 적립률 상한
| 티어 | 최대 적립률 |
|------|-------------|
| Low (GPT-4o 등) | 10% |
| Mid (Sonnet 등) | 10% |
| High (Opus 등) | 5% |

## 실제 계산 예시

### 예시 1: 단일 모델 구매 (적립 없음)
**장바구니:**
- GPT-4o × 1회 = 10원 (Free 플랜)

**계산:**
- 총 선택 수량: 1개
- 기본 적립률: 0%
- 플랜 보너스: 0%
- 총 적립률: 0%

**결과:**
- ❌ PMC 적립: **0 PMC**
- 👉 2개 이상 구매해야 적립 시작

### 예시 2: 저가 모델 2개 구매
**장바구니:**
- GPT-4o × 1회 = 10원
- Sonnet 4.5 × 1회 = 20원
- 총 결제: 30원 (Plus 플랜)

**계산:**
- 총 선택 수량: 2개
- 기본 적립률: 3%
- 플랜 보너스: 2%
- 헤드라인 적립률: 5%
- GPT-4o: 10원 × 5% = 0.5 PMC
- Sonnet 4.5: 20원 × 5% = 1.0 PMC

**결과:**
- ✅ 최종 PMC: **1 PMC** (소수점 버림)

### 예시 3: 고가 모델 구매 (티어 제한)
**장바구니:**
- Opus 4.5 × 2회 = 120원 (Max 플랜)

**계산:**
- 총 선택 수량: 2개
- 기본 적립률: 3%
- 플랜 보너스: 7%
- 헤드라인 적립률: 10%
- **티어 제한 (High)**: 5% ⚠️
- Opus 4.5: 120원 × 5% = 6 PMC

**결과:**
- ✅ 최종 PMC: **6 PMC** (고가 모델은 5% 상한)

### 예시 4: 다양한 모델 구매 (최대 적립)
**장바구니:**
- GPT-4o × 1회 = 10원
- Sonnet 4.5 × 1회 = 20원
- Haiku 3.5 × 1회 = 4원
- Sonar × 1회 = 1원
- 총 결제: 35원 (Max 플랜)

**계산:**
- 총 선택 수량: 4개
- 기본 적립률: 9%
- 플랜 보너스: 7%
- 헤드라인 적립률: 11.9% (수수료율 상한)
- GPT-4o: 10원 × 10% = 1.0 PMC (티어 상한)
- Sonnet 4.5: 20원 × 10% = 2.0 PMC (티어 상한)
- Haiku 3.5: 4원 × 10% = 0.4 PMC (티어 상한)
- Sonar: 1원 × 10% = 0.1 PMC (티어 상한)

**결과:**
- ✅ 최종 PMC: **3 PMC** (소수점 버림)

## 유저에게 보이는 설명

> "**2개 이상** 모델 선택 시 PMC 적립!  
> 적립률은 3%부터 시작해서 최대 10%까지!  
> 💡 **팁**: 여러 모델을 섞어 담을수록 적립률 증가!"

## 🛠️ 개발자용 구현 요약

### 단계별 계산
1. 총 선택 수량 계산: `totalQuantity = Σ quantity_i`
2. 기본 적립률: `R_base = min(3% × (totalQuantity - 1), 10%)`
3. 플랜 보너스: `R_plan` (Free: 0%, Plus: 2%, Pro: 5%, Max: 7%)
4. 헤드라인 적립률: `R_headline = min(R_base + R_plan, 11.9%)`
5. 모델별 적립:
   - 티어별 상한 적용 (Low/Mid: 10%, High: 5%)
   - `effectiveRate = min(R_headline, tierCap)`
   - `modelPMC = modelPrice × effectiveRate`
6. 최종 PMC: `totalPMC = floor(Σ modelPMC)`

### 구현 위치
- **파일:** `src/utils/pricing.ts`
- **함수:** `calculatePMCEarn()`

## ✅ 최종 결론

**현재 PMC 시스템의 장점:**
- ✅ **수익성 보장**: 적립률이 수수료율(11.9%)을 초과하지 않음
- ✅ **예측 가능**: 사용자가 쉽게 이해
- ✅ **다양성 유도**: 여러 모델을 섞어 담을수록 적립률 증가
- ✅ **공정성**: 모든 구매자에게 동일하게 적용
- ✅ **역마진 방지**: 고가 모델(Opus)은 5% 상한으로 제한
